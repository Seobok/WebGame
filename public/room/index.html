<!DOCTYPE html>
<html>
    <body>
        <ul id="messages" type="none">
            <li id="usercount"></li>
            <li id="nickname"></li>
            <li id="list"></li>
        </ul>

        <script src="https://cdn.socket.io/4.5.3/socket.io.min.js" integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi" crossorigin="anonymous"></script>
        <script>
            var name = null;   //유저 닉네임
            //TODO 유저가 자신의 sids ID를 가지고 있어야 하는지 동형에게 질문

            params = (new URL(document.location)).searchParams
            id = params.get('roomId')
            
            socket = io('localhost:52273',{
                query: {
                    roomId : id
                }
            });

            socket.emit('roomMemberList', id)       //방에 있는 userList 요청

            socket.on('userCount', (count) => {
                var userCounter = document.getElementById('usercount');
                userCounter.innerHTML = "현재 " + count + "명이 서버에 접속해있습니다." + '<br>';
            })

            socket.on('userNick', (nickname) => {
                name = nickname
                var userNickname = document.getElementById('nickname');
                userNickname.innerHTML = "현재 당신의 닉네임 : " + name;
            })

            socket.on('userList', (list) => {
                var userList = document.getElementById('list')
                for(e of list.values()){
                    userList.innerHTML += `${e} : ${list}<br>`
                }
            })
        </script>
    </body>
</html>