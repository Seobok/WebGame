<!DOCTYPE html>
<html>
    <body>
        <ul id="messages" type="none">
            <li id="usercount"></li>
            <li id="nickname"></li>
            <li id="userlist"></li>
            <li id="roommaster"></li>
            <li id="gamestartbtn"></li>
        </ul>

        <script src="https://cdn.socket.io/4.5.3/socket.io.min.js" integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi" crossorigin="anonymous"></script>
        <script>
            params = (new URL(document.location)).searchParams
            id = params.get('roomId')
            
            socket = io('localhost:52273',{
                query: {
                    roomId : id
                }
            });

            socket.emit('roomMemberList', id)

            socket.on('userCount', (count, nick) => {
                var userCounter = document.getElementById('usercount');
                var userList = document.getElementById('userlist');
                var output='';
                userCounter.innerHTML = "현재 " + count + "명이 서버에 접속해있습니다." + '<br>';
                for(let item of nick) {
                    output += item + '<br>'
                }
                userList.innerHTML = output
            })

            socket.on('userNick', (nickname) => {
                this.nickname = nickname
                var userNickname = document.getElementById('nickname');
                userNickname.innerHTML = "현재 당신의 닉네임 : " + this.nickname;
            })

            socket.on('findRoomMaster', (name) => {
                if(this.nickname == name)
                    roomMaster = true;
                var chkroomMaster = document.getElementById('roommaster');
                chkroomMaster.innerHTML = "방장? : " + roomMaster;

                if(roomMaster) {
                    var gamestartbtn = document.getElementById('gamestartbtn');
                    gamestartbtn.innerHTML = "<button id = 'start'>게임시작</button>"
                    var btn = document.getElementById('start')
                    btn.onclick = function() {
                        console.log("gameStart");
                    }
                }
            })
        </script>
    </body>
</html>